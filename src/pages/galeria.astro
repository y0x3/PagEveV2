<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Galería Completa</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/styles/galeria.css" />
  </head>
  <body>
    <h1>Galería Completa</h1>

    <div class="gallery-container" id="galleryContainer">
      <p>Cargando imágenes...</p>
    </div>

    <footer>
      <a href="/" style="text-decoration: none; color: inherit;">
        Regresar a la página principal
      </a>
    </footer>

    <script is:inline>
      document.addEventListener('DOMContentLoaded', () => {
        const galleryContainer = document.getElementById('galleryContainer');
    
        if (!galleryContainer) {
          console.error("El contenedor de la galería no se encontró en el DOM.");
          return;
        }
    
        // Función para cargar las imágenes desde la API
        async function loadGallery() {
          try {
            const response = await fetch('/api/cloudinary-list', {
              cache: 'no-store', // Asegúrate de que no use caché
            });
    
            if (!response.ok) {
              throw new Error(`Error al obtener las imágenes: ${response.statusText}`);
            }
    
            const data = await response.json();
    
            // Limpia el contenedor antes de agregar nuevas imágenes
            galleryContainer.innerHTML = '';
    
            // Agrega las imágenes al contenedor
            data.images.forEach((url) => {
              const card = document.createElement('div');
              card.className = 'card'; // Aplica el estilo de la tarjeta
    
              const img = document.createElement('img');
              img.src = url;
              img.alt = 'Imagen de la galería';
              img.className = 'gallery-image';
    
              card.appendChild(img); // Agrega la imagen dentro de la tarjeta
              galleryContainer.appendChild(card); // Agrega la tarjeta al contenedor
            });
          } catch (error) {
            console.error('Error al cargar la galería:', error);
          }
        }
    
        // Llama a la función para cargar la galería
        loadGallery();
      });
    </script>
  </body>
</html>